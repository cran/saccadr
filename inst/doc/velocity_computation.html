<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Velocity computation</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Velocity computation</h1>



<p>Because the gaze samples tend to be noisy, different methods use
various approaches for computing velocity from noisy samples. Methods by
<span class="citation">Engbert and Kliegl (2003)</span> and <span class="citation">Otero-Millan et al. (2014)</span> used the same
approach based on averaging over multiple samples to compute velocity,
whereas <span class="citation">Nyström and Holmqvist (2010)</span>
compute a simple derivative and then filter it. By default, package uses
the former approach (<code>velocity_function = diff_ek</code>) but you
can also use the latter (<code>velocity_function = diff_nh</code>) or
implement a custom method (see below). Acceleration is computed the same
way but from velocity samples.</p>
<div id="differentiation-following-engbertkliegl2003" class="section level2">
<h2>Differentiation following <span class="citation">Engbert and Kliegl
(2003)</span></h2>
<p>This method computes velocity over a predefined time window
controlled via <code>ek_velocity_time_window</code> that defaults to 20
ms. The width of the window is converted to samples based on the
<code>sampling_rate</code> parameter and is ensured to be an
<em>odd</em> number equal to or larger than 3. I.e., for a window that
is three samples long, the velocity is computed based on one sample
before and one sample after the current, for a five-samples window - two
samples before and after, etc. The code always starts with the requested
window size but all iteratively reduces it by two samples to accommodate
for trial limits and missing values. An <code>NA</code> velocity is
returned only if even the smallest window (three samples wide) cannot be
used.</p>
<p>In general, horizontal and vertical velocity components are computed
as <span class="math display">\[v_x[i] =
\frac{\sum_{j=1}^{(N-1)/2}x[i+j] -
x[i-j]}{\sum_{j=1}^{(N-1)/2}2j\cdot\Delta t}\]</span> where <span class="math inline">\(i\)</span> is the index of a sample, <span class="math inline">\(\Delta t = \frac{1}{sample~rate}\)</span> is a
duration of a single sampling frame, and <span class="math inline">\(N\)</span> is an <em>odd</em> integer width of the
moving average used to compute the velocity. In <span class="citation">Engbert and Kliegl (2003)</span>, <span class="math inline">\(N=5\)</span> and <span class="math inline">\(\Delta t = 4\)</span> (250 Hz sampling rate)
translate into a 20 ms moving average window (default value used in the
method implementation). Below is a derivation that shows the equivalence
of the formula above to formula 1 in <span class="citation">Engbert and
Kliegl (2003)</span>. For <span class="math inline">\(N=5\)</span>:
<span class="math display">\[\frac{\sum_{j=1}^{(5-1)/2}x[i+j] -
x[i-j]}{\sum_{j=1}^{(5-1)/2}2j\cdot\Delta t}=\]</span> <span class="math display">\[\frac{\sum_{j=1}^{2}x[i+j] -
x[i-j]}{\sum_{j=1}^{2}2j\cdot\Delta t}=\]</span></p>
<p><span class="math display">\[\frac{x[i+1] - x[i-1]+x[i+2] -
x[i-2]}{2\Delta t + 4\Delta t}=\]</span> <span class="math display">\[\frac{x[i+2] + x[i+1] - x[i-1] - x[i-2]}{6\Delta
t}\]</span></p>
</div>
<div id="differentiation-following-nystromholmqvist2010" class="section level2">
<h2>Differentiation following <span class="citation">Nyström and
Holmqvist (2010)</span></h2>
<p>Horizontal and vertical components of velocity are computed from
adjacent samples, the amplitude is computed from the components and then
is filtered using the <a href="https://en.wikipedia.org/wiki/Savitzky%E2%80%93Golay_filter">Savitzky-Golay
filter</a>. Filter order is controlled via
<code>nh_sg_filter_order</code> option and defaults to
<code>2</code>.</p>
</div>
<div id="comparing-two-methods" class="section level2">
<h2>Comparing two methods</h2>
<p>The two methods produce comparable but different velocity values.
However, this has only a minor effect on saccade detection, see a
vignette on <em>Using sample votes</em>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># computing velocity using two methods</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>vel_ek <span class="ot">&lt;-</span> saccadr<span class="sc">::</span><span class="fu">diff_ek</span>(<span class="at">x =</span> single_trial<span class="sc">$</span>x,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>                           <span class="at">y =</span> single_trial<span class="sc">$</span>y,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>                           <span class="at">trial =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(single_trial)),</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>                           <span class="at">sample_rate =</span> <span class="dv">500</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>vel_nh <span class="ot">&lt;-</span> saccadr<span class="sc">::</span><span class="fu">diff_nh</span>(<span class="at">x =</span> single_trial<span class="sc">$</span>x,</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>                           <span class="at">y =</span> single_trial<span class="sc">$</span>y,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>                           <span class="at">trial =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(single_trial)),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>                           <span class="at">sample_rate =</span> <span class="dv">500</span>)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>vel_comparison <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(<span class="fu">data.frame</span>(<span class="at">EK =</span> vel_ek[[<span class="st">&#39;amp&#39;</span>]], <span class="at">NH =</span> vel_nh[[<span class="st">&#39;amp&#39;</span>]])) <span class="sc">%&gt;%</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(NH <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="co"># values can be negative due to filtering</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">logEK =</span> <span class="fu">log</span>(EK), <span class="at">logNH =</span> <span class="fu">log</span>(NH)) </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="co"># plotting amplitude comparison</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>pearson_rho <span class="ot">&lt;-</span> <span class="fu">cor</span>(vel_comparison[[<span class="st">&#39;EK&#39;</span>]], vel_comparison[[<span class="st">&#39;NH&#39;</span>]])</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> vel_comparison, <span class="fu">aes</span>(<span class="at">x =</span> EK, <span class="at">y =</span> NH)) <span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">sprintf</span>(<span class="st">&quot;Pearson&#39;s ρ = %.2f</span><span class="sc">\n</span><span class="st">Pearson&#39;s ρ for log transformed velocities = %.2f&quot;</span>, pearson_rho, <span class="fu">cor</span>(vel_comparison[[<span class="st">&#39;logEK&#39;</span>]], vel_comparison[[<span class="st">&#39;logNH&#39;</span>]])),</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Vek&quot;</span>,</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Vnh&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># plotting </span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="cn">NULL</span>, <span class="fu">aes</span>(<span class="at">x =</span> vel_comparison[[<span class="st">&#39;EK&#39;</span>]] <span class="sc">-</span> vel_comparison[[<span class="st">&#39;NH&#39;</span>]])) <span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>) <span class="sc">+</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Vek - Vnh&quot;</span>) <span class="sc">+</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Difference in velocities computed via two methods&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAAGACAMAAAAtcPVNAAABIFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYzMzM6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshZWVlmAABmADpmOgBmOmZmZgBmZmZmkJBmkNtmtrZmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQZgCQZjqQZmaQkGaQkLaQtpCQttuQ27aQ2/+rbk2rbm6ryKur5OSr5P+2ZgC2Zjq2kDq2tpC2ttu229u22/+2/7a2/9u2///Ijk3I///bkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb///kq27k///r6+v/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///97rY5aAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATcUlEQVR4nO2c/UPbxhnHDQmOs259wS0pzV66JE1DksK2rl3oCmvXbAluujXAjGsM+v//i92dXiwZGYSt5/SI+3x/iPwife6RfB/rTiLuRIQEnE7TBRDSZBCABB0EIEEHAUjQQQASdBCABB0EIEEHAUjQWVCAQcflNy/N47OdtcMo+ken0z10/yxeTExacC338ui3rypSrhNLvdhct0JdZVtWbnL+jlxsnCyY5QTodB4mH/zQPO66f5YoZnkBBqsSAljqxeaqCFC2ZeUmEcBDFhXAfbBnP/ZWXsQvDK0K7h/xXNbBF+5wl6aaAFW3rNwkAnjIUgLYLr/uPqd9892/+jv7z6vol/vx2Mh8SoPO6svc87Xv3+msfGq3e9Pr3HbqpG+6WFJ+rayh081ulOccxs9uv8yxzMtvd0wF69P34xHanzudlQdZ5YWWLWDUW3/TM+0Ne533Dk1L68OMd+h24sxR86Vaxg9pH8wqjDd4804nq95t+YF7eWAJrt9OC49mG8/aOEt35Of7Cay4u67xmR0jC2VJAZIumxdg1LNDI3NmONu51eusHeaeZ6OmYfJSlL2Zo2Vr2Yx69oE9teQ4dsiVbTicvpwTYLbV9NSUtZwBRr13zcOVr3pu/Ha6aZ9lzeQEmJbqxn+373dnKozHYPnq4y0Hdpt9OzY03T1XeLxxvvGsjVSA2/fTA3ax8ZkdI4tlSQGi/dVXyRwgGQKd7dhvpZ967hNy33q5513bQ+wj81G+cSeP9E2XRIBkreylpJUpx631wHYG+yhj5eYA07VHvfetDhkuWzsFmE73wLzkuvja4emmaf7su053KkA6HkmJp5srX0e/7JRUaNtddSeVbu44WUMM1jwauq6dtOveLzaeOxxxk3a1H10t6VbTxos7RhZM7QLYb7l4BdMZXkUXntvRTPJa/k33NOlCyVpJS6bH5rYZxO0lH/z+youMVRBguvaod+sPP2R151qeArq2PbOx3dA9mO7WVIA8cT0qdPKkwmTI/t/v/9Lr5AVw1d/90qy1ny98WkbWeO5wxDsyPWDF3R05s/M7RhZM7QIMk8tD9svOdojZ57ZHxaOGKP+me5oOqPKzPDdsuMBNCEPbIxJWQYAc2I7OOu+9TGmFoVUMWE+F27cCuIYH+XIddUqMp/oXK8wNvQoCWOxw9V+bD838Itdutu208VzV00lw7oANC40XdowsmJrmAHICuBlGoQNeU4Dop/tubuJWkhAgrTA+gXTe/es/f94sCGAa2Tczia5ts0YBCjtGFkxNV4HyQ6B0WhZ/frPP488zG4gU5nBlApi++LfN7izn6iFQAfyfPyWTxdIhUFGAuHnD2c/GYulIPsoxpoO0tMJpu8U5gHn6x531aLD2ncPMDIHyjeeqnhWguLtZ49mOkQWz7H2A9HPKT4K/jsw0bTqInn2eTIJHm27Wl7zpqKUCjHq/j2+35Tkzk+CYZQVILt9M1x52PjAD7O+yc0y29nQSXBTArO8mwWaI8ambuEcJNSWaeeiD5I2ZCp2Yh/aSZXoB310BOtu5dfeF+fp+x1kyMwnON547HIP8dajiJDhpvLhjZMHUdyf4YXY3zGU9nRTOPHdde5hum73pUiqA+bSdH0XOzGXQdAg+SC+D5tZ2D9IeOW15ehm0KMCtXjKwGKYXHB01V+r0jUKF+Yu4mQBug0HHffe7L+vZy6D5xnNtZDuSHLDi7uYug9Z91zu0LCXAynvZ3wLl7gSPzND01oPpHdvi87hrv+kl93DSN11KBcguiRY5o/ydoZX05dP7ne7b7H0HdveL3s+6SaHl5EZYcQ5gb0o58I/mwVtbiKUe5ko1g+/b/75QoSvA3bD6ej8dmcdbDjvdZFgV5QuPLggwbWO6I/GhmG6VNT6zY2Sh8NegxeSG9iSEIEAxCBBYEKAYBAgsCFAMAgQWBCBBBwFI0EEAEnQQgAQdBCBBBwFI0FlMgP/Ny/x3lgpYsDVjEQBs0FgEABs0FgHABo1FALBBYxEAbNBYBAAbNBYBwAaNRQCwQWMRAGzQWAQAGzQWAcAGjUUAsEFjEQBs0FgE0I39OJcasSUJFIsAurEIIIxFAN1YBBDGIoBuLAIIYxFANxYBhLGVBDjf3Y6iydP+xnG2QAA/WAQQxlYS4Ki/7SQ4upcuEMATFgGEsVUEGH/+xXY0eX4QjR8fJAsE8IRFAGFsBQHOv/nWfO2PnxxHk2d7ycK8fMfkstMGqSN5AZqu5UbnEgGOtuy452TD9fxkkbwlL2joWM4AwtirBTDf+edlZwAE8IFFAGHs1QIc9W22mAM0gkUAYWyFIVB8GfR8dyu+CrTFVSCPWAQQxlYWgPsAjWARQBhbSYC5ka8vdCwCCGMRQDcWAYSxCKAbiwDCWATQjUUAYSwC6MYigDAWAXRjEUAYiwC6sQggjEUA3VgEEMYigG4sAghjEUA3FgGEsQigG4sAwlgE0I1FAGEsAujGIoAwFgF0YxFAGIsAurEIIIxFAN1YBBDGIoBuLAIIYxFANxYBhLEIoBuLAMJYBNCNRQBhLALoxiKAMBYBdGMRQBiLALqxCCCMRQDdWAQQxiKAbiwCCGMRQDcWAYSxCKAbiwDC2OUEINLJC9B0LTc6nAF0YjkDCGMRQDcWAYSxCKAbiwDCWATQjUUAYSwC6MYigDAWAXRjEUAYiwC6sQggjEUA3VgEEMYigG4sAghjEUA3FgGEsQigG4sAwlgE0I1FAGEsAujGIoAwFgF0YxFAGIsAurEIIIxFAN1YBBDGIoBuLAIIYxFANxYBhLEIoBuLAMJYBNCNRQBhLALoxiKAMBYBdGMRQBiLALqxCCCMRQDdWAQQxiKAbiwCCGMRQDcWAYSxCKAbiwDCWATQjUUAYSwC6MYigDAWAXRjEUAYW0GAk37/o4MomjztbxxnCwTwg0UAYezVAowfH0RH96Lz3e3cAgE8YRFAGFttCGQkmDw/yC0QwBMWAYSx1QQw3/njJ8fR5NlesjCv3TG5dCNSQ/ICNF3Ljc5lAowffbgXnWy4np8sknfkBQ0dyxlAGFtFgCj31T89AyCADywCCGOrCRC93mYO0AgWAYSxVwuQDHrOd7fiq0BbXAXyiEUAYWyFM8BRv2/mANwHaASLAMLYikOgOZGvL3QsAghjEUA3FgGEsQigG4sAwlgE0I1FAGEsAujGIoAwFgF0YxFAGIsAurEIIIxFAN1YBBDGIoBuLAIIYxFANxYBhLEIoBuLAMJYBNCNRQBhLALoxiKAMBYBdGMRQBiLALqxCCCMRQDdWAQQxiKAbiwCCGMRQDcWAYSxCKAbiwDCWATQjUUAYSwC6MYigDAWAXRjEUAYiwC6sQggjEUA3VgEEMYigG7sx/NSA7sYxQdBEosAurEIIIxFAN1YBBDGIoBuLAIIY5cTgEhnrgBNF3bTwhlAJ5YzgDAWAXRjEUAYiwC6sQggjEUA3VgEEMYigG4sAghjEUA3FgGEsQigG4sAwlgE0I1FAGEsAujGIoAwFgF0YxFAGIsAurEIIIxFAN1YBBDGlglwuvnQLoarrxCgaSwCCGMRQDcWAYSxFwUYdNJ0r+r/CCCORQBh7CVngAqRry90LAIIY8sEqB75+kLHIoAwtlSAUc8NgZgDNI9FAGFsmQBnO1eP/hHADxYBhLFlAjAH0INFAGFs+RkAAbRgEUAYWyZAlTsACOAHiwDC2DIBTjc7TIKVYBFAGFt6Bqgc+fpCxyKAMBYBdGMRQBhbJgBDID1YBBDGzj8DnH7ygjNA41gEEMbOFyAarh0iQNNYBBDGXiYAQ6DmsQggjL1EgH3OAM1jEUAYWyZAMgleSeYA40f9/nYUTZ72N46zBQL4wSKAMPaSM0CSybO9aPzZ3vnudnR0L0oWCOAJiwDC2KsFOLHd/fX25PlBNH58kCwQwBMWAYSx5QK4/xa5XjgLjJ8c5xbmtTsmc60hNWWuAE0XdtNSEGBgr/+cbmYGnO9uRScbrucni+QNeUFDx3IGEMaWCTD7qxCTp1tmKjx7BkAAH1gEEMZWEGD8aNtawBygCSwCCGOvHgLF/d8Ng9xVoC2uAnnEIoAwtlSAwiT4qG+zzX2ARrAIIIwtF6Bq5OsLHYsAwlgE0I1FAGFsqQBnO+vVfhtFvr7QsQggjC0VYL8bVft1IPn6QscigDC2TAB+HVoPFgGEsQigG4sAwtgyAS78KQQCNIZFAGFsqQDRcOaP4RCgKSwCCGPLBaga+fpCxyKAMBYBdGMRQBiLALqxCCCMRQDdWAQQxiKAbiwCCGMRQDcWAYSxCKAbiwDCWARQh53b5xFAAIsA6rAI4BOLAOqwCOATiwDqsAjgE4sA6rAI4BOLAOqwCOATiwDqsAjgE4sA6rAI4BOLAOqwCOATiwDqsAjgE4sA6rAI4BOLAOqwCOATiwDqsAjgE7ucAEQg1QRousqbFs4AarCcAXxiEUAdFgF8YhFAHRYBfGIRQB0WAXxiEUAdFgF8YhFAHRYBfGIRQB0WAXxiEUAdFgF8YhFAHRYBfGIRQB0WAXxiEUAdFgF8YhFAHRYBfGIRQB0WAXxiEUAdFgF8YhFAHRYBfGIRQB0WAXxiEUAdFgF8YhFAHRYBfGIRQB0WAXxiEUAdFgF8YhFAHRYBfGIRQB0WAXxiEUAdFgF8YhFAHRYBfGIRQB0WAXxiEUAdFgF8YhFAHRYBfGIRQB0WAXxiEUAdFgF8YhFAHRYBfGIrCTB+fBBFk6f9jeNsgQBiWATwia0iwEn/o4PofHc7OrqXLhBADosAPrEVBHj94d/NGWDy/MCeCZIFAshhEcAntvIQaPzkOJo820sW5sU7JpdtRBZMNQGarvKm5UoBTjZcz08WyRvyggaI5QzgE1tZgAtnAAQQwiKAT2xlAZgD+MIigE9sZQHOd7fiq0BbXAWSxSKAT2xlAbgP4AuLAD6xlQSYG/n6AsQigE8sAqjDIoBPLAKowyKATywCqMMigE8sAqjDIoBPLAKowyKATywCqMMigE8sAqjDIoBPLAKowyKATywCqMMigE8sAqjDIoBPLAKowyKATywCqMMigE8sAqjDIoBPLAKowyKATywCqMMigE8sAqjDIoBPLAKowyKATywCqMMigE8sAqjDIoBPLAKowyKATywCqMMigE8sAqjDIoBPLAKowyKATywCqMMigE8sAmjAVuvzCCCARQANWARoDIsAGrAI0Bh2OQFIPVlAgKZLvmnhDNAkljNAY1gE0IBFgMawCKABiwCNYRFAAxYBGsMigAYsAjSGRQANWARoDIsAGrAI0BgWATRgEaAxLAJowCJAY1gE0IBFgMawCKABiwCNYRFAAxYBGsMigAYsAjSGRQANWARoDIsAGrAI0BgWARrCLtDnEUAAiwANYRFABxYBGsIigA4sAjSERQAdWARoCIsAOrAI0BAWAXRgEaAhLALowCJAQ1gE0IFFgIawCKADiwD+sMv2eVkb2n1sFwchAAKUVltTtGMRwB8WARRiEcAfFgEUYhHAHxYBFGIRYEFshQ4YSfZ5BKgJdF0BJk/7G8cIgAA3BHtdAc53t6Oje8oEWLYzLLL93G3Ee3tJFtjnC9HeU4Ww1xVg8vwgGj8+qChArZ+SXDdZmtySzN3p3Ed22Yc2/51qh3MR2JzMdL2K+1wGuqYA4yfH0eTZnnl0x6TiRoRoT1UBTjZSAWyqClpXwIKtGXtdAaZnAAQAewOw1xXgenOAugMWbM3Y6wpwvrul7yoQWLALg64pAPcBwN4o7LUFKES+PrBgRbEIADZoLAKADRqLAGCDxiIA2KCxCAA2aCwCgA0aiwBgg8YuJ8DctOvvRKlWLm2pFgFaE6qVCAK0JlQrEQRoTahWIjULQEi7ggAk6CAACToIQIIOApCgU6MA40f9jw5m/uuY5tjf+mpNtW2p06VNR7Y+AexvRhxtHBd/Qk5zjvrbUVuqbUudcdp0ZOsTwP1wyvOD4s9HKM748y+2o7ZU25Y6XVp1ZGs/AxR/QEhvzr/51nxHtaXattRp064jW+McIB70FX9CTm+OtuxJui3VtqVOm3Yd2XoEeN3v3xt/thedfHTQAvNdtU/cbKUF1bq0pc7IldqmI1vfGSBRviVjv6O+zVZLqm3NiDpq3ZGtcRIcnwGKPyGnOfZ7qi3VtqXOOG06sjXOAU76/Q/3WnP9t11Xq1tTp0ubjix3gknQQQASdBCABB0EIEEHAUjQQQASdBCgmZztdN1y0E1fGd19sdBKZKkgQEMZrL6KbBd/mL5Q1rcrrUSWCQI0lLgrj371qvjCAiuRZYIATWV/PYoHN2c7nY75prd9e9jplq80uvtVr9N5aJZfduyS1BUEaCrDtUM3uHED/cHaoRFg1Jvt2ulKo555YAZE6bKRim9kEKCpnH7ywg1uhrY7n24+tF/y6/NWcmqkijAOqjEI0FjM8MaOgAYdl/VRr2xsk6zk+rwVIFk2UO4NDQI0luHaW3t5x4x+3FPz5b6fPLROrBdWQgCpIEBjOf3kK3t5Z7gSd2fTrU83S8ZAbiUEkAoCNJf9X9trPmc75nvfWGC79WDlQteOV0IAqSBAcxnGY357GdR0fNutnQxlKyGAVBCABB0EIEEHAUjQQQASdBCABB0EIEEHAUjQQQASdBCABB0EIEHn/5XFdAFNBksMAAAAAElFTkSuQmCC" width="100%" /></p>
</div>
<div id="implementing-and-using-a-custom-differentiation-function" class="section level2">
<h2>Implementing and using a custom differentiation function</h2>
<p>A custom function should be as a follows</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>diff_custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y,  trial, sample_rate, <span class="at">options=</span><span class="cn">NULL</span>) {</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="co"># compute vertical and horizontal components</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> ..., <span class="co"># differentiate values of x </span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>                   <span class="at">y =</span> ...) <span class="co"># differentiate values of y</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  </span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="co"># compute amplitude</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  df[[<span class="st">&#39;amp&#39;</span>]] <span class="ot">=</span> <span class="fu">sqrt</span>(df[[<span class="st">&#39;x&#39;</span>]]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> df[[<span class="st">&#39;y&#39;</span>]]<span class="sc">^</span><span class="dv">2</span>)<span class="er">)</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="co"># return a data.frame with columns x, y, and amp</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>  <span class="fu">return</span>(df)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>}</span></code></pre></div>
<p>Arguments that are passed to the function (all vectors have the same
length):</p>
<ul>
<li><code>x</code>, <code>y</code> vectors with values, either x and y
gaze coordinates or velocity components (for acceleration).</li>
<li><code>sample_rate</code> scalar value in Hz.</li>
<li><code>trial</code> vector with trial index per sample.</li>
<li><code>options</code> a named list with method-specific options. See
the example below for how to use them. See also
<code>option_or_default()</code> function.</li>
</ul>
<p>The function must return a data.frame with three columns:
<code>x</code> (horizontal component), <code>y</code> (vertical
component), and <code>amp</code> (amplitude).</p>
<p>Here is an example of a simple velocity function that respects trial
borders</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>diff_custom <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y,  trial, sample_rate, <span class="at">options=</span><span class="cn">NULL</span>) {</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="co"># computing frame time step </span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  delta_t_s <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> sample_rate</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="co"># --- differentiate (compute velocity or acceleration) and filter</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">trial =</span> trial,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>             <span class="at">x =</span> x,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>             <span class="at">y =</span> y) <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    <span class="co"># compute velocity and acceleration for each trial</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    <span class="fu">group_by</span>(trial) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">x =</span> (x <span class="sc">-</span> <span class="fu">lag</span>(x)) <span class="sc">/</span> delta_t_s,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>           <span class="at">y =</span> (y <span class="sc">-</span> <span class="fu">lag</span>(y)) <span class="sc">/</span> delta_t_s,</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>           <span class="at">amp =</span> <span class="fu">sqrt</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>}</span></code></pre></div>
<p>And here is a similar function but that uses an optional
<code>custom_velocity_lag</code> parameter so that it can be different
from 1</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>diff_lag_n <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y,  trial, sample_rate, <span class="at">options=</span><span class="cn">NULL</span>) {</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="co"># obtain lag or use default</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  lag_n <span class="ot">&lt;-</span> saccadr<span class="sc">::</span><span class="fu">option_or_default</span>(options, <span class="st">&quot;custom_velocity_lag&quot;</span>, <span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="co"># computing frame time step </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  delta_t_s <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> sample_rate</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  </span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="co"># --- differentiate (compute velocity or acceleration) and filter</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">trial =</span> trial,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>             <span class="at">x =</span> x,</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>             <span class="at">y =</span> y) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    <span class="co"># compute velocity and acceleration for each trial</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>    <span class="fu">group_by</span>(trial) <span class="sc">%&gt;%</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">x =</span> (x <span class="sc">-</span> <span class="fu">lag</span>(x, lag_n)) <span class="sc">/</span> delta_t_s,</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a>           <span class="at">y =</span> (y <span class="sc">-</span> <span class="fu">lag</span>(y, lag_n)) <span class="sc">/</span> delta_t_s,</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>           <span class="at">amp =</span> <span class="fu">sqrt</span>(x<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> y<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-EngbertKliegl2003" class="csl-entry">
Engbert, Ralf, and Reinhold Kliegl. 2003. <span>“<span class="nocase">Microsaccades uncover the orientation of covert
attention</span>.”</span> <em>Vision Research</em> 43 (9): 1035–45. <a href="https://doi.org/10.1016/S0042-6989(03)00084-1">https://doi.org/10.1016/S0042-6989(03)00084-1</a>.
</div>
<div id="ref-NystromHolmqvist2010" class="csl-entry">
Nyström, Marcus, and Kenneth Holmqvist. 2010. <span>“<span class="nocase">An adaptive algorithm for fixation, saccade, and glissade
detection in eyetracking data</span>.”</span> <em>Behavior Research
Methods</em> 42 (1): 188–204. <a href="https://doi.org/10.3758/BRM.42.1.188">https://doi.org/10.3758/BRM.42.1.188</a>.
</div>
<div id="ref-Otero-Millan2014" class="csl-entry">
Otero-Millan, J., Jose L Alba Castro, Stephen L Macknik, and S.
Martinez-Conde. 2014. <span>“<span class="nocase">Unsupervised
clustering method to detect microsaccades</span>.”</span> <em>Journal of
Vision</em> 14 (2): 18–18. <a href="https://doi.org/10.1167/14.2.18">https://doi.org/10.1167/14.2.18</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
